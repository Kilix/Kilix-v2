var Kilix={currentScroll:null,currentPos:null,animSvg:!$("html").hasClass("no-anim-svg"),colors:{col1:"#61AFF0",col2:"#ff4a46",col3:"#009884",col4:"#e79027",col5:"#087ec2"},init:function(){Kilix.resize(),Kilix.pushState(),Kilix.switchSVG(),Kilix.nav(),setTimeout(function(){Kilix[$(".container").data("page")].init()},300)},resize:function(){Kilix.resizeLanding(),$(window).resize(function(){Kilix.resizeLanding()})},resizeLanding:function(){var a=$(window).height();matchMedia("(min-width: 40em)").matches?($(".landing-home").css("height",a),$(".home .intro.desktop").css("margin-top",a)):($(".landing-home").attr("style",""),$(".home .intro.desktop").attr("style",""))},pushState:function(){function a(a){var b=a.url,d=$(".container").data("page");$("title").html(g[a.title.toLowerCase()]),c=f[a.title.toLowerCase()],$(".nav-link.current").removeClass("current"),$('.nav-link[data-pos="'+c+'"]').addClass("current"),e=c>Kilix.currentPos?!0:!1,$(".main-wrapper").append("<div class='wrapper wrapper-new'></div>"),e||$(".wrapper-new").addClass("wrapper-prev"),$(".wrapper-new").load(b+" .container",function(b){Kilix[d].destroy(),Kilix.resizeLanding(),Kilix.switchSVG();var c=$(".wrapper:first-child"),f=$(".wrapper-new"),g=$(".main-wrapper");$("html, body").scrollTop(0);var h=e?"page-moveToLeftEasing":"page-moveToRightEasing",j=e?"page-moveFromRight":"page-moveFromLeft";c.addClass(h).addClass("page-ontop"),f.addClass(j).on(i,function(){f.off(i),g.removeClass("page-perspective"),$(".wrapper:first-child").remove(),$(".wrapper").removeClass(j),$(".wrapper-new").removeClass("wrapper-new"),$(".wrapper-prev").removeClass("wrapper-prev"),$(".nav-links-wrapper a, .footer-links a").addClass("enabled"),Pos=$(".container").data("pos"),Kilix[a.title.toLowerCase()].init()})})}function b(b){a(b)}"file:"===document.location.protocol&&alert("The HTML5 History API (and thus History.js) do not work on files, please upload it to a server.");var c,d=window.History,e=(d.getState(),!0),f={home:1,team:2,agilite:3,references:4,contact:5},g={home:$("#link-home").attr("title"),team:$("#link-team").attr("title"),agilite:$("#link-agilite").attr("title"),references:$("#link-references").attr("title"),contact:$("#link-contact").attr("title")},h={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},i=h[Modernizr.prefixed("animation")];Modernizr.cssanimations;d.Adapter.bind(window,"statechange",function(){var a=d.getState();if(""==a.title){url=a.url;var c=/^https?:\/\/[a-z\:0-9.\-\_]+/,e="",f=c.exec(url);null!=f&&(e=f[0]),e.length>0&&(url=url.replace(e,""),url=url.replace("/",""),""==url&&(url="home")),a.title=url.toLowerCase()}b(a)}),history.pushState&&$(".nav-links-wrapper a.enabled, .footer-links a.enabled").on("click",Kilix.bindPushState)},bindPushState:function(a){if(a.preventDefault(),$(this).hasClass("enabled")&&!$(this).hasClass("current")){$(".nav-links-wrapper a, .footer-links a").removeClass("enabled"),$("body").removeClass("unfolded"),Kilix.currentPos=$(".nav-link.current").data("pos"),void 0!=$(this).data("scroll")?Kilix.currentScroll=$(this).data("scroll"):Kilix.currentScroll=null;var b=$(this).attr("data-scroll")?$(this).data("page-title"):this.textContent;History.pushState(null,b,this.href),a.preventDefault()}},switchSVG:function(){Modernizr.svg?$("img.svg").each(function(){var a=$(this),b=a.attr("id"),c=a.attr("class"),d=a.attr("src");$.get(d,function(d){var e=$(d).find("svg");"undefined"!=typeof b&&(e=e.attr("id",b)),"undefined"!=typeof c&&(e=e.attr("class",c+" replaced-svg")),e=e.removeAttr("xmlns:a"),a.replaceWith(e)})}):$('img.svg[src*="svg"]').attr("src",function(){return $(this).attr("src").replace(".svg",".png")})},nav:function(){$(".toggle-menu").on("click",function(){$(".nav-links-wrapper").removeClass("nav-links-hidden"),$("body").toggleClass("unfolded"),window.setTimeout(function(){$("body").hasClass("unfolded")||$(".nav-links-wrapper").addClass("nav-links-hidden")},605)}),$(".back-to-top").on("click",function(){$("html, body").animate({scrollTop:0},"slow")}),$(".nav-link-contact").on("click",function(){$("html, body").animate({scrollTop:$("body").height()},"slow")})},wayPoints:function(){$(".intro").waypoint(function(a){$(".navbar").toggleClass("navbar-top"),"down"==a?$(".back-to-top").addClass("show-back"):$(".back-to-top").removeClass("show-back")},{offset:"100px"}),$(".landing h1, .landing-main-text, #KILIX-logo").on("click",function(){$("html, body").animate({scrollTop:$(".intro").offset().top-80},"slow")})},changeXColor:function(a,b){"none"!=b?($(".logo").addClass("animated"),setTimeout(function(){$(".logo").removeClass("animated")},2e3),a.each(function(a){var c=$(this);setTimeout(function(){c.css("fill",b)},100*(a+1))})):($(".logo").addClass("animated"),setTimeout(function(){$(".logo").removeClass("animated")},2e3),a.each(function(a){var b=$(this);setTimeout(function(){b.attr("style","")},100*(a+1))}))},animations:{},home:{init:function(){Kilix.wayPoints(),Kilix.resize(),$(".landing-home").addClass("play"),setTimeout(function(){$(".landing-home").removeClass("play")},1e3);var a="50%";history.pushState&&$(".svg-anim a.button.enabled").on("click",Kilix.bindPushState),$(".next-section").on("click",function(){$("html, body").animate({scrollTop:$(this).closest(".❤").next().offset().top-90},"slow")}),$(".losange").on("click",function(){$("html, body").animate({scrollTop:$(".svg-valeur").offset().top-90},"slow")}),$(".intro").waypoint({handler:function(a){Kilix.changeXColor($(".logo svg polygon"),"none")},offset:"25%"});var b=$(".❤");if(b.waypoint({handler:function(a){var b=Kilix.colors[$(this).data("color")];Kilix.changeXColor($(".logo svg polygon"),b)},offset:"25%"}),Kilix.animSvg){var c=!1;Kilix.animations.risques.setAnimStatus(!1),$(".svg-risque").waypoint(function(a){0==c&&Kilix.animations.risques.start(),c=!0},{offset:a});var d=!1;Kilix.animations.valeur.setValueAnimStatus(!0),Kilix.animations.valeur.setValueLoadingStatus(!1),$(".svg-valeur").waypoint(function(a){0==d&&Kilix.animations.valeur.start(),d=!0},{offset:a});var e=!1;Kilix.animations.amelioration.setAnimStatus(!1),$(".svg-amelio").waypoint(function(a){0==e&&Kilix.animations.amelioration.start(),e=!0},{offset:a});var f=!1;Kilix.animations.extia.setAnimStatus(!1),$(".svg-extia").waypoint(function(a){0==f&&Kilix.animations.extia.start(),f=!0},{offset:a}),null!=Kilix.currentScroll&&$("html, body").animate({scrollTop:$(".scroll-item").eq(Kilix.currentScroll).offset().top-200},"slow")}$(".png-anim").on("click",function(){var a=new Image;a.style.height=$(this).height()+"px",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.marginTop="-"+$(this).height()+"px",a.style.display="none",$(this).off(),$(this).after(a),a.onload=function(a,b){a.style.display="block",b.css("opacity",0)}(a,$(this)),a.src=$(this).attr("data-gif")})},destroy:function(){Kilix.animations.extia.freeIntervals(),Kilix.animations.valeur.freeIntervals(),Kilix.animations.risques.freeIntervals(),$.waypoints("destroy"),$(".svg-anim a.button.enabled").off(),$(".next-section").off(),$(".navbar").addClass("navbar-top"),Kilix.changeXColor($(".logo svg polygon"),"none"),$(".landing h1, .landing-main-text, #KILIX-logo").off()}},agilite:{init:function(){Kilix.wayPoints(),Kilix.switchSVG(),$(".button-back").on("click",Kilix.bindPushState),$(".losange").on("click",function(){$("html, body").animate({scrollTop:$(".content.desktop").offset().top-90},"slow")}),setTimeout(function(){Kilix.changeXColor($(".logo svg polygon"),"none")},300);var a=!1;$(".svg-agilite").eq("0").waypoint(function(b){0==a&&(setTimeout(function(){Kilix.animations.agilite.startValueAnimation()},500),a=!0)},{offset:"70%"});var b=!1;$(".svg-agilite").eq("1").waypoint(function(a){0==b&&(Kilix.animations.agilite.startRiskAnimation(),b=!0)},{offset:"70%"});var c=!1;$(".svg-agilite").eq("2").waypoint(function(a){0==c&&(Kilix.animations.agilite.startAdaptAnimation(),c=!0)},{offset:"70%"});var d=!1;$(".svg-agilite").eq("3").waypoint(function(a){0==d&&(Kilix.animations.agilite.startVisAnimation(),d=!0)},{offset:"70%"}),null!=Kilix.currentScroll&&$("html, body").animate({scrollTop:$(".scroll-item").eq(Kilix.currentScroll).offset().top-150},"slow")},destroy:function(){$(".navbar").addClass("navbar-top"),$.waypoints("destroy"),Kilix.changeXColor($(".logo svg polygon"),"none"),$(".landing h1, .landing-main-text, #KILIX-logo").off(),$(".button-back").off()}},team:{init:function(){Kilix.wayPoints();var a="70%";if($(".losange").on("click",function(){$("html, body").animate({scrollTop:$(".svg-anim").offset().top-90},"slow")}),Kilix.animSvg){var b=!1;Kilix.animations.team.setAnimStatus(!1),$(".svg-team").waypoint(function(a){0==b&&Kilix.animations.team.start(),b=!0},{offset:a})}setTimeout(function(){Kilix.changeXColor($(".logo svg polygon"),Kilix.colors.col3)},300),$(".raptor").on("click",function(){$("body").raptorize()})},destroy:function(){$.waypoints("destroy"),$(".navbar").addClass("navbar-top"),$(".landing h1, .landing-main-text, #KILIX-logo").off(),Kilix.changeXColor($(".logo svg polygon"),"none")}},references:{init:function(){Kilix.wayPoints();setTimeout(function(){Kilix.changeXColor($(".logo svg polygon"),Kilix.colors.none)},300)},destroy:function(){$.waypoints("destroy"),$(".navbar").addClass("navbar-top"),$(".landing h1, .landing-main-text, #KILIX-logo").off(),Kilix.changeXColor($(".logo svg polygon"),"none")}}};$(function(){Kilix.init()});